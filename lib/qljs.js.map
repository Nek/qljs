{"version":3,"sources":["webpack://qljs/webpack/universalModuleDefinition","webpack://qljs/webpack/bootstrap","webpack://qljs/./src/index.ts","webpack://qljs/./src/utils.ts","webpack://qljs/external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\",\"umd\":\"react\"}","webpack://qljs/external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\",\"umd\":\"react-dom\"}"],"names":[],"mappings":"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","file":"qljs.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"react-dom\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"react-dom\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qljs\"] = factory(require(\"react\"), require(\"react-dom\"));\n\telse\n\t\troot[\"qljs\"] = factory(root[\"React\"], root[\"ReactDOM\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE_react__, __WEBPACK_EXTERNAL_MODULE_react_dom__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { first, zip } from './utils'\n\nconst noMatch = (term: string) => {\n  throw new Error('No match for ' + term)\n}\n\nexport function multimethod(dispatch) {\n  const dict = {}\n  if (typeof noMatch == 'function') {\n    dict['noMatch'] = noMatch\n  }\n\n  return new Proxy(\n    () => {\n      throw new Error('No match')\n    },\n    {\n      set(target, property, value) {\n        dict[property] = value\n        return true\n      },\n      get(target, property, receiver) {\n        return dict[property]\n      },\n      apply(target, thisArg, args) {\n        const value = dispatch.apply(null, args)\n        const func =\n          value && dict.hasOwnProperty(value)\n            ? dict[value]\n            : dict.hasOwnProperty('noMatch')\n              ? dict['noMatch']\n              : target\n        return func.apply(thisArg, args)\n      },\n    },\n  )\n}\n\n\nlet Component\nlet element\nlet state\nlet remoteHandler\nlet parsers\n\nconst isMutationQuery = ([tag]) => {\n  return parsers.mutate[tag] ? true : false\n}\n\nconst registry = new Map()\n\nexport function query(query, key) {\n  registry.set(key, query)\n  return key\n}\n\nexport function getQuery(key) {\n  return registry.get(key)\n}\n\nexport function clearRegistry() {\n  registry.clear()\n}\n\nconst parseQueryTerm = (queryTerm, env) => {\n  const mutateFn = parsers.mutate && parsers.mutate[queryTerm[0]]\n  if (mutateFn) {\n    mutateFn(queryTerm, env, state)\n  } else {\n    return parsers.read(queryTerm, env, state)\n  }\n}\n\nconst parseQuery = (query, env) => {\n  if (env === undefined) {\n    return parseQuery(query, {})\n  }\n\n  return query.map(queryTerm => {\n    return parseQueryTerm(queryTerm, env)\n  })\n}\n\nexport function parseQueryIntoMap(\n  query,\n  env,\n  _state = state,\n  _parsers = parsers,\n) {\n  const queryName = query.map(first)\n  const queryResult = parseQuery(query, env)\n  const atts = zip(queryName, queryResult).reduce(\n    (res, [k, v]) => ({ ...res, [k]: v }),\n    {},\n  )\n\n  return {\n    env,\n    query,\n    ...atts,\n  }\n}\n\nfunction parseQueryRemote(query) {\n  return query.reduce((acc, item) => {\n    if (parsers.remote[first(item)]) {\n      const v = parsers.remote(item, state)\n      if (v) {\n        return [...acc, v]\n      } else {\n        return acc\n      }\n    } else {\n      return acc\n    }\n  }, [])\n}\n\nexport function parseChildrenRemote([dispatchKey, params, ...chi]) {\n  const chiRemote = parseQueryRemote(chi)\n  return Array.isArray(chiRemote) && [...[dispatchKey, params], ...chiRemote]\n}\n\nfunction parseQueryTermSync(queryTerm, result, env) {\n  const syncFun = parsers.sync[queryTerm[0]]\n  if (syncFun) {\n    syncFun(queryTerm, result, env, state)\n  } else {\n    //TODO: Missing sync parser warning\n  }\n}\n\nfunction performRemoteQuery(query) {\n  if (Array.isArray(query) && remoteHandler) {\n    remoteHandler(query, results => {\n      zip(query, results).map(([k, v]) => parseQueryTermSync(k, v, {}))\n      refresh(false)\n    })\n  }\n}\n\nexport function mapDelta(map1, map2) {\n  return Object.entries(map2)\n    .filter(([k, v]) => v !== map1[k])\n    .reduce((res, [k, v]) => ({ ...res, [k]: v }), {})\n}\n\nexport function loopRootQuery(queryTerm, env?) {\n  if (env) {\n    const parentEnv = env.parentEnv\n    const newEnv = { ...(parentEnv ? mapDelta(parentEnv, env) : env) }\n    delete newEnv.parentEnv\n    delete newEnv.queryKey\n    return loopRootQuery([env.queryKey, newEnv, queryTerm], parentEnv)\n  } else {\n    return queryTerm\n  }\n}\n\nexport function makeRootQuery(env, query) {\n  return query.map(queryTerm => {\n    return loopRootQuery(queryTerm, env.parentEnv)\n  })\n}\n\nexport function parseChildren(term, env, _state = state, _parsers = parsers) {\n  const [, , ...query] = term\n  const newEnv = { ...env, parentEnv: { ...env, queryKey: term[0] } }\n  return parseQueryIntoMap(query, newEnv, _state, _parsers)\n}\n\nexport function transact(props, query, _state = state, _parsers = parsers) {\n  const { env, query: componentQuery } = props\n  const rootQuery = makeRootQuery(env, [...query, ...componentQuery])\n  parseQuery(rootQuery, env)\n  const q = parseQueryRemote(rootQuery)\n  performRemoteQuery(q)\n  refresh(false)\n}\n\nexport function createInstance(Component, atts) {\n  const { env, query } = atts\n  return React.createElement(Component, {\n    ...atts,\n    env,\n    query,\n    key: env.id ? env.id : '_',\n  })\n}\n\nlet refresh = isRemoteQuery => {\n  const query = getQuery(Component)\n  const atts = parseQueryIntoMap(query, {})\n  if (isRemoteQuery) {\n    performRemoteQuery(parseQueryRemote(query))\n  }\n  ReactDOM.render(createInstance(Component, atts), element)\n}\n\nexport function mount({ state: _st, parsers: _parsers, remoteHandler: _rh }) {\n  state = _st\n  parsers = _parsers\n  remoteHandler = _rh\n  return ({ component, element: _el }) => {\n    Component = component\n    element = _el\n    refresh(true)\n  }\n}\n\nexport function _mount({\n  component,\n  element: _el,\n  state: _st,\n  remoteHandler: _rh,\n  parsers: _parsers,\n}) {\n  Component = component\n  element = _el\n  state = _st\n  remoteHandler = _rh\n  parsers = _parsers\n  refresh(true)\n}\n","export const flatten = (acc, val) => [...acc, ...val]\nexport const extractJson = body => body.json()\nexport const zip = (a1, a2) => a1.map((x, i) => [x, a2[i]])\nexport const first = ([f]) => f\n","module.exports = __WEBPACK_EXTERNAL_MODULE_react__;","module.exports = __WEBPACK_EXTERNAL_MODULE_react_dom__;"],"sourceRoot":""}